<?xml version='1.0' encoding='utf-8'?>
<command>
    <title>Operaci칩n Upsert (MERGE)</title>
    <description>Actualiza registros existentes e inserta nuevos en una sola operaci칩n.</description>
    <parts>
        <part>
            <text>MERGE INTO target_table</text>
            <desc>Identifica la tabla destino que recibir치 los cambios.</desc>
        </part>
        <part>
            <text>USING source_updates</text>
            <desc>Identifica la tabla o vista origen que contiene los datos nuevos/actualizados.</desc>
        </part>
        <part>
            <text>ON target_table.id = source_updates.id</text>
            <desc>Establece la condici칩n de enlace (llave) para determinar si un registro ya existe.</desc>
        </part>
        <part>
            <text>WHEN MATCHED THEN UPDATE SET *</text>
            <desc>Si las llaves coinciden, actualiza todos los campos de la tabla destino.</desc>
        </part>
        <part>
            <text>WHEN NOT MATCHED THEN INSERT *</text>
            <desc>Si no hay coincidencia, inserta el registro nuevo completo.</desc>
        </part>
    </parts>
    <full>spark.sql("MERGE INTO target_table USING source_updates ON target_table.id = source_updates.id WHEN MATCHED THEN UPDATE SET * WHEN NOT MATCHED THEN INSERT *")</full>
</command>